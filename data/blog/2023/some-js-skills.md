---
title: 'jsä¸­çš„é‚£äº›æŠ€æœ¯ç‚¹'
date: Sat May 13 2023 23:13:13 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
lastmod: '2023-05-13'
tags: ['js']
draft: false
summary: 'å“ªäº›jsä¸­çš„æŠ€èƒ½ç‚¹'
layout: PostSimple
bibliography: references-data.bib
canonicalUrl: https://dume.vercel.app/blog/2023/some-js-skills
---

## å˜é‡æå‡

### å‡½æ•°ä¸å˜é‡

```js
var a = 1
function a() {}
console.log(a)

// æå‡åçš„æ•ˆæœå¦‚ä¸‹ï¼ˆä¼ªä»£ç ï¼‰ï¼š
// var a è¢«å‡½æ•°è¦†ç›–
function a() {}
a = 1 // é‡æ–°èµ‹å€¼
console.log(a) // 1
```

```js
console.log(a)
var a = 1
function a() {}

// æå‡åçš„æ•ˆæœ
// var a è¢«å‡½æ•°è¦†ç›–
function a() {}
console.log(a) // æ‰“å°å‡½æ•°
a = 1
```

### åŸç†

Promise æ˜¯ JavaScript ä¸­ä¸€ç§**å¤„ç†å¼‚æ­¥æ“ä½œçš„æ–¹å¼ï¼Œå®ƒçš„åŸç†æ˜¯åŸºäºå¼‚æ­¥æ“ä½œçš„çŠ¶æ€æœº**åŒ…å«ä¸‰ç§çŠ¶æ€ï¼špendingï¼ˆç­‰å¾…ä¸­ï¼‰ã€fulfilledï¼ˆå·²æˆåŠŸï¼‰ã€rejectedï¼ˆå·²å¤±è´¥ï¼‰ã€‚

å½“ Promise å¯¹è±¡çš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œä¼šè§¦å‘ç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚

## SDK

### sdk éªŒç­¾

ç­¾åï¼Œå…¶å®ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ä¸€äº›ç®—æ³•ï¼Œç”Ÿæˆçš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åå†åŠ å¯†å¾—åˆ°ã€‚

1. è·å–éœ€è¦éªŒç­¾çš„æ•°æ®å’Œç­¾åï¼ˆé€šå¸¸æ˜¯å­—ç¬¦ä¸²æˆ–è€…äºŒè¿›åˆ¶æ•°æ®ï¼‰ã€‚
2. è·å–å…¬é’¥ï¼ˆä¹Ÿå¯ä»¥æ˜¯è¯ä¹¦æˆ–è€…å¯†é’¥å¯¹ï¼‰ï¼Œé€šå¸¸æ˜¯ä»æœåŠ¡å™¨è·å–ã€‚
3. å°†å…¬é’¥è½¬æ¢ä¸ºå¯ä»¥è¢« js ä½¿ç”¨çš„æ ¼å¼ï¼Œé€šå¸¸æ˜¯å°†å…¬é’¥è½¬æ¢ä¸º PEM æ ¼å¼æˆ–è€… DER æ ¼å¼ã€‚
4. ä½¿ç”¨ js çš„åŠ å¯†åº“ï¼ˆå¦‚ CryptoJSï¼‰å°†æ•°æ®è¿›è¡Œå“ˆå¸Œæˆ–è€…åŠ å¯†æ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ªå“ˆå¸Œå€¼æˆ–è€…åŠ å¯†åçš„æ•°æ®ã€‚
5. å°†å“ˆå¸Œå€¼æˆ–è€…åŠ å¯†åçš„æ•°æ®ä¸ç­¾åè¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™éªŒç­¾é€šè¿‡ï¼Œå¦åˆ™éªŒç­¾å¤±è´¥ã€‚
6. å¯¹äºæŸäº›ç‰¹æ®Šçš„éªŒç­¾ç®—æ³•ï¼Œå¯èƒ½è¿˜éœ€è¦å¯¹ç­¾åè¿›è¡Œè§£å¯†æˆ–è€…è§£å‹ç¼©æ“ä½œï¼Œä»¥å¾—åˆ°åŸå§‹çš„å“ˆå¸Œå€¼æˆ–è€…æ•°æ®ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ JS ä¸­è¿›è¡ŒéªŒç­¾æ“ä½œéœ€è¦ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ï¼Œé¿å…æ•°æ®æ³„éœ²æˆ–è€…è¢«ç¯¡æ”¹ã€‚å› æ­¤ï¼Œå»ºè®®ä½¿ç”¨ HTTPS åè®®ä¼ è¾“æ•°æ®ï¼Œä½¿ç”¨ SSL/TLS ç­‰å®‰å…¨åè®®ä¿æŠ¤æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­çš„å®‰å…¨æ€§ã€‚åŒæ—¶ï¼Œä¹Ÿéœ€è¦ä¿è¯æœåŠ¡å™¨æä¾›çš„å…¬é’¥æ˜¯å¯ä¿¡çš„ï¼Œé¿å…è¢«æ¶æ„ç¯¡æ”¹ã€‚

### å…¬é’¥è½¬æ¢

å°†å…¬é’¥è½¬æ¢ä¸º JS å¯ä½¿ç”¨çš„æ ¼å¼éœ€è¦å°†å…¬é’¥è¿›è¡Œç¼–ç ã€‚å¸¸ç”¨çš„ç¼–ç æ ¼å¼æœ‰ DER å’Œ PEM ã€‚ä»¥ä¸‹æ˜¯å°† DER ç¼–ç çš„å…¬é’¥è½¬æ¢ä¸º JS å¯ä½¿ç”¨çš„æ ¼å¼çš„æ­¥éª¤ï¼š

1. å°† DER ç¼–ç çš„å…¬é’¥è½¬æ¢ä¸º Uint8Array ç±»å‹ã€‚
2. å°† Uint8Array ç±»å‹çš„å…¬é’¥è¿›è¡Œ Base64 ç¼–ç ã€‚
3. æ„é€  JS å¯ä½¿ç”¨çš„å…¬é’¥æ ¼å¼ï¼Œä¾‹å¦‚ï¼š

```js
const publicKey = '-----BEGIN PUBLIC KEY-----\n' + base64PublicKey + '\n-----END PUBLIC KEY-----'
```

å…¶ä¸­ï¼Œ**base64PublicKey å³ä¸ºç¬¬ 2 æ­¥ä¸­å¾—åˆ°çš„ Base64 ç¼–ç ï¼Œæ³¨æ„ï¼Œä¸Šå›¾ä¸å°±æ˜¯æˆ‘ä»¬å¸¸è§çš„å…¬é’¥å½¢å¼å—**ã€‚

4. å°†å…¬é’¥å­—ç¬¦ä¸²ä¼ å…¥ JS åŠ å¯†åº“ä¸­ä½¿ç”¨ã€‚

æ³¨æ„ï¼šå¦‚æœå…¬é’¥å·²ç»æ˜¯ PEM æ ¼å¼çš„ï¼Œåˆ™æ— éœ€è¿›è¡Œè½¬æ¢ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚

### DER å’Œ PEM

DER (Distinguished Encoding Rules) å’Œ PEM (Privacy-Enhanced Mail) æ˜¯ä¸¤ç§å¸¸è§çš„ç¼–ç æ ¼å¼ã€‚

DER æ˜¯ä¸€ç§äºŒè¿›åˆ¶æ ¼å¼ï¼Œç”¨äºè¡¨ç¤º X.509 æ•°å­—è¯ä¹¦ã€å…¬é’¥ã€ç§é’¥å’Œå…¶ä»–è¯ä¹¦ç›¸å…³çš„æ•°æ®ã€‚å®ƒæ˜¯ä¸€ç§è¾ƒä¸ºç´§å‡‘çš„ç¼–ç æ ¼å¼ï¼Œé€‚ç”¨äºç½‘ç»œä¼ è¾“å’Œå­˜å‚¨ã€‚DER ç¼–ç ä¸åŒ…æ‹¬ä»»ä½•å¤´éƒ¨æˆ–å°¾éƒ¨ä¿¡æ¯ï¼Œå› æ­¤å®ƒçš„å¤§å°æ¯” PEM æ ¼å¼å°ã€‚

PEM æ˜¯ä¸€ç§åŸºäº ASCII ç çš„ç¼–ç æ ¼å¼ï¼Œå¸¸ç”¨äºè¡¨ç¤ºè¯ä¹¦ã€å…¬é’¥ã€ç§é’¥å’Œå…¶ä»–æ•°æ®ã€‚PEM æ ¼å¼ä½¿ç”¨ -----BEGIN å’Œ -----END å¼€å¤´å’Œç»“å°¾çš„æ ‡è®°æ¥æ ‡è¯†æ•°æ®ç±»å‹ï¼Œä»¥åŠ BASE64 ç¼–ç æ¥è¡¨ç¤ºæ•°æ®ã€‚PEM ç¼–ç å¯ä»¥åŒ…å«å¤šä¸ªæ•°æ®å—ï¼Œæ¯ä¸ªæ•°æ®å—å¯ä»¥åŒ…å«å¤šä¸ªè¡Œï¼Œæ¯è¡Œçš„é•¿åº¦é€šå¸¸ä¸è¶…è¿‡ 64 ä¸ªå­—ç¬¦ã€‚

æ‰‹åŠ¨å®ç°ä¸€ä¸ª DER å’Œ PEM å…¬é’¥çš„ç›¸äº’è½¬åŒ–

```js
// å…¬é’¥ã€åŸæ ¼å¼å’Œç›®æ ‡æ ¼å¼ã€‚
// å…¬é’¥åº”è¯¥æ˜¯ä¸€ä¸ªBufferå¯¹è±¡ï¼ŒåŸæ ¼å¼å’Œç›®æ ‡æ ¼å¼å¯ä»¥æ˜¯"DER"æˆ–"PEM"
function convertPublicKey(publicKey, fromFormat, toFormat) {
  // å°†DERæ ¼å¼çš„å…¬é’¥è½¬æ¢ä¸ºPEMæ ¼å¼
  if (fromFormat === 'DER' && toFormat === 'PEM') {
    const base64DERKey = publicKey.toString('base64')
    const pemKey = `-----BEGIN PUBLIC KEY-----\n${base64DERKey.replace(
      /(.{64})/g,
      '$1\n'
    )}\n-----END PUBLIC KEY-----\n`
    return pemKey
  }

  // å°†PEMæ ¼å¼çš„å…¬é’¥è½¬æ¢ä¸ºDERæ ¼å¼
  if (fromFormat === 'PEM' && toFormat === 'DER') {
    const base64PEMKey = publicKey
      .toString()
      .split('\n')
      .filter((line) => !line.includes('BEGIN') && !line.includes('END'))
      .join('')
    const derKey = Buffer.from(base64PEMKey, 'base64')
    return derKey
  }

  // å¦‚æœæ ¼å¼ä¸åŒ¹é…ï¼Œè¿”å›null
  return null
}
```

**æ³¨æ„ï¼š**ä¸Šé¢çš„ toString æ–¹æ³•ï¼Œå¯ä»¥ä¼ å…¥ 'base64' å…¥å‚ã€‚ã€‚ã€‚è¿™ä¸ª toString å’Œå­—ç¬¦ä¸²è½¬æ¢çš„é‚£ä¸ªä¸ä¸€æ ·ã€‚ã€‚ã€‚è¿™æ˜¯ Buffer å¯¹è±¡ä¸Šçš„æ–¹æ³•

Buffer å¯¹è±¡çš„ toString æ–¹æ³•ç”¨äºå°† Buffer å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚

è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼šencoding å’Œ startã€‚

- encoding å‚æ•°æŒ‡å®šäº†å­—ç¬¦ä¸²çš„ç¼–ç æ ¼å¼ï¼Œé»˜è®¤ä¸º utf8ã€‚
- start å‚æ•°æŒ‡å®šäº†ä»å“ªä¸ªä½ç½®å¼€å§‹è½¬æ¢ï¼Œé»˜è®¤ä¸º 0ã€‚

```js
const buf = Buffer.from('hello world', 'utf8')
const str = buf.toString()
console.log(str) // è¾“å‡ºï¼šhello world

const str = buf.toString('base64', 2)
console.log(str) // è¾“å‡ºï¼šbGVsbG8gd29ybGQ=
```

## ç¼–ç¨‹èŒƒå¼

### å‡½æ•°æŸ¯ç†åŒ–

å‡½æ•°æŸ¯é‡ŒåŒ–æ˜¯ä¸€ç§å°†ä¸€ä¸ªæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬å˜ä¸ºä¸€ç³»åˆ—åªæ¥å—å•ä¸€å‚æ•°çš„å‡½æ•°çš„æŠ€æœ¯ã€‚

å…¶åŸç†æ˜¯å°†ä¸€ä¸ªæ¥æ”¶å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬åŒ–ä¸ºä¸€ä¸ªåªæ¥æ”¶ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæ–°çš„å‡½æ•°æ¥æ”¶å‰©ä½™çš„å‚æ•°ï¼Œæœ€ç»ˆè¿”å›ç»“æœã€‚

åº•å±‚å®ç°å¯ä»¥é‡‡ç”¨é—­åŒ…å’Œé€’å½’çš„æ–¹å¼å®ç°ã€‚å…·ä½“å®ç°å¦‚ä¸‹ï¼š

```js
// å…¥å‚æ˜¯åŸå§‹å‡½æ•°
function curry(fn) {
  return function curried(...args) {
    // å¦‚æœæ–°å‡½æ•°çš„å…¥å‚æ•°é‡è¾¾åˆ°åŸå§‹å‡½æ•°çš„é•¿åº¦ï¼Œåˆ™ç›´æ¥æ‰§è¡Œ
    // fn.length æ˜¯å½¢å‚çš„ä¸ªæ•°
    if (args.length >= fn.length) {
      return fn.apply(this, args)
    } else {
      // å¦åˆ™ï¼Œç»§ç»­è¿”å›å‡½æ•°ï¼Œå¹¶æ‹¼æ¥å‚æ•°
      return function (...arg1) {
        return curried.apply(this, args.concat(arg1))
      }
    }
  }
}
```

è¿™é‡Œä½¿ç”¨äº†é—­åŒ…ï¼Œå°†åŸå§‹å‡½æ•° fn ä¿å­˜åœ¨å¤–éƒ¨å‡½æ•° curry çš„ä½œç”¨åŸŸä¸­ã€‚

å½“è°ƒç”¨ curry å‡½æ•°æ—¶ï¼Œè¿”å›ä¸€ä¸ªå†…éƒ¨å‡½æ•° curriedï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°...argsï¼Œå¦‚æœå‚æ•°ä¸ªæ•°å¤§äºç­‰äºåŸå§‹å‡½æ•° fn çš„å‚æ•°ä¸ªæ•°ï¼Œåˆ™ç›´æ¥è°ƒç”¨åŸå§‹å‡½æ•° fn å¹¶è¿”å›ç»“æœï¼Œ

å¦åˆ™è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶å‰©ä½™çš„å‚æ•°...args2ï¼Œå¹¶å°† args å’Œ args2 åˆå¹¶åé€’å½’è°ƒç”¨ curried å‡½æ•°ï¼Œç›´åˆ°å‚æ•°ä¸ªæ•°è¶³å¤Ÿè°ƒç”¨åŸå§‹å‡½æ•° fnã€‚

```js
// æ±‚å’Œ
function add(a, b, c) {
  return a + b + c;
}

const curriedAdd = curry(add);

console.log(curriedAdd(1)(2)(3)); // 6
console.log(curriedAdd(1, 2)(3)); // 6
console.log(curriedAdd(1)(2, 3)); // 6
console.log(curriedAdd(1, 2, 3)); // 6

// é—®å€™
function greet(greeting, name) {
  return ${greeting}, ${name}!;
}

const curriedGreet = curry(greet);

console.log(curriedGreet('Hello')('John')); // Hello, John!
console.log(curriedGreet('Hi', 'Mary')); // Hi, Mary!
```

#### æŸ¯ç†åŒ–äº§ç”Ÿçš„åŸå› 

æŸ¯é‡ŒåŒ–çš„äº§ç”Ÿæºäºå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ï¼Œå®ƒæ˜¯**ä¸€ç§å°†å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢ä¸ºä¸€ç³»åˆ—åªæ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°çš„æŠ€æœ¯**ã€‚**æŸ¯é‡ŒåŒ–çš„ä¸»è¦ç›®çš„æ˜¯ç®€åŒ–å‡½æ•°çš„è°ƒç”¨æ–¹å¼å’Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚**

åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå‡½æ•°è¢«è§†ä¸ºä¸€ç­‰å…¬æ°‘ï¼Œå®ƒä»¬å¯ä»¥åƒå…¶ä»–æ•°æ®ç±»å‹ä¸€æ ·è¢«ä¼ é€’å’Œæ“ä½œã€‚å› æ­¤ï¼Œå°†ä¸€ä¸ªå¤šå‚æ•°çš„å‡½æ•°è½¬æ¢ä¸ºä¸€ç³»åˆ—åªæ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¯ä»¥æ›´æ–¹ä¾¿åœ°å°†å‡½æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°æˆ–è€…ç»„åˆå‡½æ•°ã€‚æ­¤å¤–ï¼ŒæŸ¯é‡ŒåŒ–è¿˜å¯ä»¥é™ä½å‡½æ•°çš„è€¦åˆåº¦ï¼Œä½¿å¾—ä»£ç æ›´æ˜“äºæµ‹è¯•å’Œé‡æ„ã€‚

å› æ­¤ï¼ŒæŸ¯é‡ŒåŒ–æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚

æŸ¯é‡ŒåŒ–çš„ä¸»è¦ç›®çš„æ˜¯ç®€åŒ–å‡½æ•°çš„è°ƒç”¨æ–¹å¼å’Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºè¿™ç§ç®€åŒ–æ•ˆæœï¼Ÿ

å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•° addï¼Œç”¨äºè®¡ç®—ä¸¤ä¸ªæ•°å­—çš„å’Œï¼š

```js
function add(x, y) {
  return x + y
}
```

é€šè¿‡æŸ¯é‡ŒåŒ–ï¼Œå¯ä»¥å°†è¿™ä¸ªå‡½æ•°è½¬æ¢ä¸ºæ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ç¬¬äºŒä¸ªå‚æ•°å¹¶è¿”å›ç»“æœã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›´ç®€å•çš„æ–¹å¼è°ƒç”¨ add å‡½æ•°ï¼š

```js
function add(x) {
  return function (y) {
    return x + y
  }
}

// è°ƒç”¨æ–¹å¼
add(2)(3) // 5
```

è¿™ç§æ–¹å¼å°†å‡½æ•°è°ƒç”¨æ‹†åˆ†ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œä½¿ä»£ç æ›´æ˜“è¯»å’Œç»´æŠ¤ã€‚æ­¤å¤–ï¼Œè¿™ç§æ–¹å¼è¿˜å…è®¸æˆ‘ä»¬éƒ¨åˆ†åº”ç”¨å‡½æ•°ï¼Œå³é¢„å…ˆè®¾ç½®ä¸€äº›å‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œä»¥ä¾¿ç¨åè°ƒç”¨ã€‚ä¾‹å¦‚ï¼š

```js
const addTwo = add(2)
addTwo(3) // 5
addTwo(4) // 6
```

### AOPï¼ˆAspect-Oriented Programmingï¼‰

AOPï¼ˆAspect-Oriented Programmingï¼‰ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå®ƒå¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡åˆ‡é¢ï¼ˆAspectï¼‰çš„æ–¹å¼æ¥å¢å¼ºç¨‹åºçš„åŠŸèƒ½ã€‚

AOP çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç¨‹åºçš„å…³æ³¨ç‚¹ï¼ˆConcernï¼‰åˆ†ç¦»å‡ºæ¥ï¼Œé€šè¿‡åˆ‡é¢æ¥å®ç°è¿™äº›å…³æ³¨ç‚¹çš„åŠŸèƒ½ï¼Œä»è€Œå®ç°ä»£ç çš„è§£è€¦å’Œå¤ç”¨ã€‚

åœ¨ JavaScript ä¸­ï¼ŒAOP ç¼–ç¨‹é€šå¸¸é€šè¿‡æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ–è€…è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ¥å®ç°ã€‚

æ‹¦æˆªå™¨æ˜¯ä¸€ç§èƒ½å¤Ÿåœ¨å‡½æ•°æ‰§è¡Œå‰ã€æ‰§è¡Œåæˆ–è€…æŠ›å‡ºå¼‚å¸¸æ—¶æ‹¦æˆªå‡½æ•°è°ƒç”¨çš„æœºåˆ¶ï¼Œé€šè¿‡æ‹¦æˆªå™¨å¯ä»¥å®ç°æ—¥å¿—è®°å½•ã€æ€§èƒ½ç»Ÿè®¡ã€å®‰å…¨æ£€æŸ¥ç­‰åŠŸèƒ½ã€‚è£…é¥°å™¨åˆ™æ˜¯ä¸€ç§èƒ½å¤Ÿåœ¨å‡½æ•°æˆ–è€…ç±»ä¸Šæ·»åŠ é¢å¤–åŠŸèƒ½çš„æœºåˆ¶ï¼Œé€šè¿‡è£…é¥°å™¨å¯ä»¥å®ç°ç¼“å­˜ã€æƒé™æ§åˆ¶ã€é”™è¯¯å¤„ç†ç­‰åŠŸèƒ½ã€‚

AOP ç¼–ç¨‹åœ¨ JavaScript ä¸­çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæ¯”å¦‚åœ¨ React ä¸­ä½¿ç”¨è£…é¥°å™¨æ¥å®ç°é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ã€åœ¨ Node.js ä¸­ä½¿ç”¨æ‹¦æˆªå™¨æ¥å®ç°ä¸­é—´ä»¶ç­‰ã€‚

> AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œä¸å‡½æ•°å¼ç¼–ç¨‹ä¸åŒã€‚AOP æ˜¯ä¸€ç§é€šè¿‡å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—è®°å½•å’Œäº‹åŠ¡ç®¡ç†ï¼‰ä»ä¸»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç®¡ç†å’Œç»´æŠ¤ä»£ç çš„æŠ€æœ¯ã€‚AOP ä½¿ç”¨ç‰¹å®šçš„æŠ€æœ¯å’Œå·¥å…·ï¼Œå¦‚åˆ‡é¢ã€è¿æ¥ç‚¹ã€é€šçŸ¥å’Œåˆ‡ç‚¹ç­‰ï¼Œæ¥å®ç°è¿™ç§åˆ†ç¦»ã€‚è™½ç„¶ AOP å’Œå‡½æ•°å¼ç¼–ç¨‹éƒ½ä¸é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸åŒï¼Œä½†å®ƒä»¬åˆå„è‡ªæœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œåº”ç”¨åœºæ™¯ã€‚

å®ç° AOP ç¼–ç¨‹çš„å‡ ç§æ–¹å¼ï¼š

- ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼ï¼šåœ¨å‡½æ•°æˆ–æ–¹æ³•æ‰§è¡Œå‰åæ·»åŠ é¢å¤–çš„é€»è¾‘ã€‚å¯ä»¥ä½¿ç”¨ ES6 ä¸­çš„è£…é¥°å™¨è¯­æ³•æ¥å®ç°ã€‚
- ä½¿ç”¨å‡½æ•°æŸ¯é‡ŒåŒ–ï¼šå°†åŸå‡½æ•°æ‹†åˆ†ä¸ºå¤šä¸ªå°å‡½æ•°ï¼Œæ¯ä¸ªå°å‡½æ•°æ‰§è¡Œä¸€ä¸ªç‰¹å®šçš„é€»è¾‘ï¼Œç„¶åå†å°†è¿™äº›å°å‡½æ•°ç»„åˆèµ·æ¥ã€‚
- ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä»£ç†å¯¹è±¡æ¥åŒ…è£…åŸå¯¹è±¡ï¼Œä»è€Œåœ¨æ–¹æ³•æ‰§è¡Œå‰åæ·»åŠ é¢å¤–çš„é€»è¾‘ã€‚å¯ä»¥ä½¿ç”¨ ES6 ä¸­çš„ Proxy å¯¹è±¡æ¥å®ç°ã€‚
- ä½¿ç”¨åˆ‡é¢ç¼–ç¨‹æ¡†æ¶ï¼šå¦‚ Aspect.jsï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„åˆ‡é¢ç¼–ç¨‹æ¡†æ¶ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ æ³¨è§£æ¥å®ç° AOPã€‚

```js
function log(target, name, descriptor) {
  const original = descriptor.value
  descriptor.value = function (...args) {
    console.log(`Calling function ${name} with arguments: ${args}`)
    const result = original.apply(this, args)
    console.log(`Function ${name} returned: ${result}`)
    return result
  }
  return descriptor
}

class Calculator {
  @log
  add(a, b) {
    return a + b
  }
}

const calculator = new Calculator()
console.log(calculator.add(2, 3)) // Calling function add with arguments: 2,3
// Function add returned: 5
// 5
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º log çš„è£…é¥°å™¨å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šç›®æ ‡å¯¹è±¡ã€ç›®æ ‡å‡½æ•°çš„åç§°å’Œæè¿°ç¬¦å¯¹è±¡ã€‚æˆ‘ä»¬ä½¿ç”¨ descriptor.value æ¥è·å–åŸå§‹å‡½æ•°ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨è°ƒç”¨åŸå§‹å‡½æ•°ä¹‹å‰å’Œä¹‹åè¾“å‡ºæ—¥å¿—ã€‚æœ€åï¼Œæˆ‘ä»¬è¿”å›ä¿®æ”¹åçš„æè¿°ç¬¦å¯¹è±¡ã€‚

ç„¶åï¼Œæˆ‘ä»¬åœ¨ Calculator ç±»çš„ add æ–¹æ³•ä¸Šåº”ç”¨äº†@log è£…é¥°å™¨ã€‚å½“æˆ‘ä»¬è°ƒç”¨ add æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰“å°æ—¥å¿—ã€‚

## å‡½æ•°

### ç®­å¤´å‡½æ•°

```js
// 1ã€ç®­å¤´å‡½æ•°æ²¡æœ‰prototype(åŸå‹)ï¼Œæ‰€ä»¥ç®­å¤´å‡½æ•°æœ¬èº«æ²¡æœ‰this
let a = () => {};
a.prototype; // undefined

// 2ã€ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘åœ¨å®šä¹‰çš„æ—¶å€™ç»§æ‰¿è‡ªå¤–å±‚ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°çš„thisã€‚
var a;
var barObj = { msg: 'barObj' };
var fooObj = { msg: 'fooObj' };

function foo() { a() }
function bar() {
  a = () => console.log(this.msg)
}

bar.call(barObj); // barObj å…ˆæ‰§è¡Œï¼Œå®šä¹‰ç®­å¤´å‡½æ•° aï¼Œæ­¤æ—¶ a å°±ç»‘å®šåˆ° barObj äº†

foo.call(fooObj); // barObj ç„¶åå†æ‰§è¡Œfooï¼Œå³ä½¿æƒ³å†æ¬¡ç»‘å®šthisï¼Œä½†æ˜¯ a çš„æŒ‡å‘å·²ç»ä¸å˜äº†ï¼Œè¿™é‡Œåªæ˜¯æ‰§è¡Œè€Œå·²

// ğŸ”¥ è¢«ç»§æ‰¿çš„æ™®é€šå‡½æ•°çš„thisæŒ‡å‘æ”¹å˜ï¼Œç®­å¤´å‡½æ•°çš„thisæŒ‡å‘ä¼šè·Ÿç€æ”¹å˜(å› æ­¤æƒ³ä¿®æ”¹ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘ï¼Œå¯ä»¥ä¿®æ”¹å¤–å±‚)
// ğŸ”¥ ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘å®šä¹‰æ—¶æ‰€åœ¨çš„å¤–å±‚ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè·Ÿä½¿ç”¨ä½ç½®æ²¡æœ‰å…³ç³»ã€‚

// 3ã€ç›´æ¥ä¿®æ”¹ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘æ— æ•ˆ
let fnObj = { msg: 'å°è¯•ç›´æ¥ä¿®æ”¹ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘' };
function foo() {
  a.call(fnObj); // åˆ©ç”¨callç›´æ¥ä¿®æ”¹ï¼Œæ— æ•ˆ
}
foo(); // ä¾ç„¶æ˜¯ barObj


// 4ã€ç®­å¤´å‡½æ•°å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°ï¼Œä¸¥æ ¼æ¨¡å¼å’Œéä¸¥æ ¼æ¨¡å¼ä¸‹å®ƒçš„thiséƒ½ä¼šæŒ‡å‘window(å…¨å±€å¯¹è±¡)
var arrowFn1 = () => {
  // 'use strict'
  console.log(this);
}
arrowFn1(); // window


// ä½†éœ€è¦æ™®é€šå‡½æ•°åœ¨æ˜¯å¦ä¸¥æ ¼æ¨¡å¼ä¸‹çš„thisæŒ‡å‘
function foo() {
  "use strict";
  // æ­¤æ—¶å‡½æ•°ä½“å¤„äºä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä¼šè¢«ç»‘å®šåˆ°undefined
  console.log(this.a);
}
var a = 2;
foo();      // TypeError: Cannot read property 'a' of undefined


// 5ã€ç®­å¤´å‡½æ•°çš„arguments
// 5-1ã€å¦‚æœç®­å¤´å‡½æ•°çš„thisæŒ‡å‘window(å…¨å±€å¯¹è±¡)ä½¿ç”¨argumentsä¼šæŠ¥é”™ï¼Œæœªå£°æ˜argumentsã€‚
let b = () => {
  console.log(arguments);
};
b(1, 2, 3, 4); // Uncaught ReferenceError: arguments is not defined


// 5-2ã€å¦‚æœç®­å¤´å‡½æ•°çš„thisæŒ‡å‘æ™®é€šå‡½æ•°æ—¶,å®ƒçš„argumensç»§æ‰¿äºè¯¥æ™®é€šå‡½æ•°ã€‚
function bar() {
  console.log(arguments); // 1

  bb(1.1);
  function bb() {
    console.log(arguments);            // 1.1
    let a = () => {
      console.log(arguments, 'arrow'); // 1.1 arrow
    };
    a(2); // è¿™é‡Œä¼ å…¥çš„å‚æ•°æ— æ•ˆï¼Œå› ä¸ºargumentsç»§æ‰¿äºå¤–å±‚çš„æ™®é€šå‡½æ•°
  }
}
bar(1);

// 6ã€ä½¿ç”¨newè°ƒç”¨ç®­å¤´å‡½æ•°ä¼šæŠ¥é”™
let Foo = () => {};
let b = new Foo();   // Foo is not a constructor

// 7ã€ç®­å¤´å‡½æ•°ä¸æ”¯æŒnew.target
// es6å¼•å…¥æ–°å±æ€§ï¼Œnew.targetå±æ€§ï¼Œæ™®é€šå‡½æ•°å¦‚æœé€šè¿‡newè°ƒç”¨ï¼Œnew.targetä¼šè¿”å›è¯¥å‡½æ•°çš„å¼•ç”¨ã€‚
function Foo() {
  console.log(new.target)
}
new Foo();  // FooÂ {}

let Bar = () => {
  console.log(new.target); // new.target expression is not allowed here
}
Bar();

// 7-1ã€ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘æ™®é€šå‡½æ•°ï¼Œå®ƒçš„new.targetå°±æ˜¯æŒ‡å‘è¯¥æ™®é€šå‡½æ•°çš„å¼•ç”¨ã€‚
new Bar();
function Bar() {
  let a = () => {
    console.log(new.target); // BarÂ {}
  };
  a();
}

// 8ã€ç®­å¤´å‡½æ•°ä¸æ”¯æŒé‡å¤åå­—çš„å‡½æ•°å‚æ•°
function func1(a, a) {
  console.log(a, arguments); // 2 [1,2]
}
func1(1, 2);

var func2 = (a,a) => {
  console.log(a);      // Duplicate parameter name not allowed in this context
};
func2(1, 2);
```

é¡¹ç›®ä¸­ç»å¸¸æœ‰ä¸‹é¢çš„å†™æ³•ï¼š

```js
const obj = {
  array: [1, 2, 3],
  sum: () => {
    // å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°thisä¼šæŒ‡å‘å…¨å±€å¯¹è±¡
    return this.array.push('å…¨å±€å¯¹è±¡ä¸‹æ²¡æœ‰arrayï¼Œè¿™é‡Œä¼šæŠ¥é”™') // æ‰¾ä¸åˆ°pushæ–¹æ³•
  },
}
obj.sum()

// åªéœ€
const obj = {
  array: [1, 2, 3],
  sum() {
    return this.array.push('å…¨å±€å¯¹è±¡ä¸‹æ²¡æœ‰arrayï¼Œè¿™é‡Œä¼šok')
  },
}
obj.sum() // æ™®é€šå‡½æ•°ä¸­çš„thisæŒ‡å‘è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡ï¼Œæ‰§è¡Œ obj.sum() åï¼Œsumå†…éƒ¨çš„ this å°±æŒ‡å‘äº† obj
```

- ç®­å¤´å‡½æ•°æ˜¯ç”± name å±æ€§çš„

## æ•°ç»„

### æ•°ç»„å»é‡

```js
// æ–¹å¼ä¸€
const arr = [1, 2, 2, 3, 3, 4, 5, 5]
const uniqueArr = [...new Set(arr)]
console.log(uniqueArr) // [1, 2, 3, 4, 5]

// æ–¹å¼äºŒ
const arr = [1, 2, 2, 3, 3, 4, 5, 5]
// åªå–ç¬¬ä¸€æ¬¡å‡ºç°çš„æ•°æ®
const uniqueArr = arr.filter((item, index, array) => array.indexOf(item) === index)
console.log(uniqueArr) // [1, 2, 3, 4, 5]

// æ–¹å¼ä¸‰
const arr = [1, 2, 2, 3, 3, 4, 5, 5]
const uniqueArr = arr.reduce((prev, curr) => (prev.includes(curr) ? prev : [...prev, curr]), [])
console.log(uniqueArr) // [1, 2, 3, 4, 5]

// æ–¹å¼å››
const arr = [1, 2, 2, 3, 3, 4, 5, 5]
const uniqueArr = []
for (let i = 0; i < arr.length; i++) {
  if (uniqueArr.indexOf(arr[i]) === -1) {
    uniqueArr.push(arr[i])
  }
}
console.log(uniqueArr) // [1, 2, 3, 4, 5]

// æ–¹å¼äº”
var uniqueArr = arr.reduce((map, item) => {
  map[item] = 0
  // ä¸èƒ½åœ¨é‡Œé¢ç›´æ¥è¿”å›Object.keys(map)
  // å› ä¸ºè¿™é‡Œè¿”å›çš„mapä¼šä¾ç„¶ä½œä¸ºä¸‹æ¬¡è¿­ä»£çš„åˆå§‹å€¼
  return map
}, {})
Object.keys(uniqueArr)

// æ‰¾åˆ°ä¸¤ä¸ªæ•°ç»„ä¸­ï¼Œé‡å¤çš„æ•°å­—
function findDuplicates(arr1, arr2) {
  // å°†æ•°ç»„è½¬æ¢ä¸º Setï¼Œå»é™¤é‡å¤å…ƒç´ 
  const set1 = new Set(arr1)
  const set2 = new Set(arr2)
  // ä½¿ç”¨ filter æ–¹æ³•è¿‡æ»¤å‡ºä¸¤ä¸ª Set éƒ½æœ‰çš„å…ƒç´ 
  const duplicates = [...set1].filter((item) => set2.has(item))
  return duplicates
}
```

## æ–‡ä»¶ä¸‹è½½

### å›¾ç‰‡ä¸‹è½½

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Save Image to Local Album</title>
  </head>
  <body>
    <img
      src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c94f4f5c114a4bf4b5f40ae5a8d6b805~tplv-k3u1fbpfcp-zoom-1.png"
      id="image"
    />
    <button style="width: 100px; height: 50px" id="save">ç‚¹å‡»æˆ‘ï¼Œä¿å­˜å›¾ç‰‡</button>
    <script>
      var image = document.getElementById('image')
      var saveButton = document.getElementById('save')

      saveButton.addEventListener('click', function () {
        var canvas = document.createElement('canvas')
        canvas.width = image.width
        canvas.height = image.height
        var context = canvas.getContext('2d')
        context.drawImage(image, 0, 0)

        canvas.toBlob(function (blob) {
          var url = URL.createObjectURL(blob)
          var a = document.createElement('a')
          a.href = url
          a.download = 'image.jpg'
          a.click()
          URL.revokeObjectURL(url)
        })
      })
    </script>
  </body>
</html>
```

ç”±äº JavaScript çš„åŒæºç­–ç•¥ï¼Œæ— æ³•ç›´æ¥ç›‘å¬ä¸Šé¢ a æ ‡ç­¾æ–‡ä»¶çš„ä¸‹è½½å®Œæˆäº‹ä»¶ã€‚ä½†æ˜¯ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥å®ç°ç±»ä¼¼çš„æ•ˆæœï¼š

- ä½¿ç”¨ XMLHttpRequest è¯·æ±‚æ–‡ä»¶ï¼Œç›‘å¬å…¶ load äº‹ä»¶ï¼Œç„¶åä½¿ç”¨ Blob å¯¹è±¡åˆ›å»º URLï¼Œå°†å…¶èµ‹å€¼ç»™ a æ ‡ç­¾çš„ href å±æ€§ï¼Œä»è€Œå®ç°æ–‡ä»¶ä¸‹è½½ã€‚
- ä½¿ç”¨ iframe æˆ–è€… window.open æ‰“å¼€æ–‡ä»¶ä¸‹è½½é“¾æ¥ï¼Œç„¶åä½¿ç”¨å®šæ—¶å™¨è½®è¯¢åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸‹è½½å®Œæˆã€‚
- ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚ FileSaver.jsï¼Œå®ƒæä¾›äº†ä¸€äº›æ–¹æ³•å¯ä»¥ç›´æ¥å°†æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ä¸‹è½½å®Œæˆçš„å›è°ƒå‡½æ•°ã€‚

## ç»§æ‰¿

1. åŸå‹é“¾ç»§æ‰¿ï¼šé€šè¿‡å°†å­ç±»çš„åŸå‹è®¾ç½®ä¸ºçˆ¶ç±»çš„å®ä¾‹ï¼Œå®ç°ç»§æ‰¿ã€‚ç¼ºç‚¹æ˜¯çˆ¶ç±»çš„å¼•ç”¨ç±»å‹å±æ€§ä¼šè¢«æ‰€æœ‰å­ç±»å®ä¾‹å…±äº«ã€‚
2. æ„é€ å‡½æ•°ç»§æ‰¿ï¼šé€šè¿‡åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå®ç°ç»§æ‰¿ã€‚ç¼ºç‚¹æ˜¯çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§æ— æ³•è¢«ç»§æ‰¿ã€‚
3. ç»„åˆç»§æ‰¿ï¼šå°†åŸå‹é“¾ç»§æ‰¿å’Œæ„é€ å‡½æ•°ç»§æ‰¿ç»“åˆèµ·æ¥ï¼Œæ—¢èƒ½ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§ï¼Œåˆèƒ½é¿å…å…±äº«çˆ¶ç±»å¼•ç”¨ç±»å‹å±æ€§çš„é—®é¢˜ã€‚
4. åŸå‹å¼ç»§æ‰¿ï¼šé€šè¿‡åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå°†çˆ¶ç±»å®ä¾‹ä½œä¸ºè¯¥å¯¹è±¡çš„åŸå‹ï¼Œå®ç°ç»§æ‰¿ã€‚ç¼ºç‚¹æ˜¯æ— æ³•ä¼ é€’å‚æ•°ï¼ŒåŒæ—¶å­˜åœ¨å…±äº«çˆ¶ç±»å¼•ç”¨ç±»å‹å±æ€§çš„é—®é¢˜ã€‚
5. å¯„ç”Ÿå¼ç»§æ‰¿ï¼šä½¿ç”¨åŸå‹å¼ç»§æ‰¿ï¼Œä½†åœ¨è¿”å›æ–°å¯¹è±¡ä¹‹å‰ï¼Œé€šè¿‡æ·»åŠ æ–¹æ³•ç­‰æ“ä½œï¼Œå¢å¼ºæ–°å¯¹è±¡ã€‚ç¼ºç‚¹åŒåŸå‹å¼ç»§æ‰¿ã€‚
6. å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼šé€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿çˆ¶ç±»å±æ€§å’Œæ–¹æ³•ï¼Œå†é€šè¿‡å¯„ç”Ÿå¼ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§ï¼Œå®ç°ç»§æ‰¿ã€‚æ˜¯ä¸€ç§æ¯”è¾ƒå®Œå–„çš„ç»§æ‰¿æ–¹å¼ã€‚

### åŸå‹é“¾ç»§æ‰¿

```javascript
function Parent() {
  this.name = 'parent'
}
Parent.prototype.sayName = function () {
  console.log(this.name)
}

function Child() {
  this.age = 18
}
Child.prototype = new Parent()

var child = new Child()
child.sayName() // parent
```

- å°†çˆ¶ç±»çš„å®ä¾‹ä½œä¸ºå­ç±»çš„åŸå‹
- ç¼ºç‚¹æ˜¯çˆ¶ç±»çš„å¼•ç”¨ç±»å‹å±æ€§ä¼šè¢«æ‰€æœ‰å­ç±»å®ä¾‹å…±äº«ã€‚

### å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿

```javascript
function Parent(name) {
  this.name = name
}
Parent.prototype.sayName = function () {
  console.log(this.name)
}

function Child(name, age) {
  // åœ¨å­ç±»é‡Œï¼Œè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°
  Parent.call(this, name)
  this.age = age
}

var child = new Child('child', 18)
console.log(child.name) // child
console.log(child.age) // 18
```

- åœ¨å­ç±»ä¸­ï¼Œç›´æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°
- ç¼ºç‚¹æ˜¯çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§æ— æ³•è¢«ç»§æ‰¿ã€‚

### ç»„åˆç»§æ‰¿

```javascript
function Parent(name) {
  this.name = name
}
Parent.prototype.sayName = function () {
  console.log(this.name)
}

function Child(name, age) {
  Parent.call(this, name)
  this.age = age
}
Child.prototype = new Parent()
Child.prototype.constructor = Child

var child = new Child('child', 18)
child.sayName() // child
```

- çˆ¶ç±»çš„å®ä¾‹ï¼Œä½œä¸ºå­ç±»çš„åŸå‹
- åœ¨å­ç±»çš„æ„é€ å‡½æ•°é‡Œï¼Œè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
- æ—¢èƒ½ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§ï¼Œåˆèƒ½é¿å…å…±äº«çˆ¶ç±»å¼•ç”¨ç±»å‹å±æ€§çš„é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿè¿™æ˜¯æ€ä¹ˆé¿å…çš„ï¼Ÿ

### åŸå‹å¼ç»§æ‰¿

```javascript
function createObj(o) {
  function F() {}
  F.prototype = o
  return new F()
}

var parent = {
  name: 'parent',
  sayName: function () {
    console.log(this.name)
  },
}

var child = createObj(parent)
child.sayName() // parent
```

- åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæˆ–è€…ç©ºå‡½æ•°
- é€šè¿‡åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå°†çˆ¶ç±»å®ä¾‹ä½œä¸ºè¯¥å¯¹è±¡çš„åŸå‹ï¼Œå®ç°ç»§æ‰¿ã€‚
- ç¼ºç‚¹æ˜¯æ— æ³•ä¼ é€’å‚æ•°ï¼ŒåŒæ—¶å­˜åœ¨å…±äº«çˆ¶ç±»å¼•ç”¨ç±»å‹å±æ€§çš„é—®é¢˜ã€‚

#### å¯„ç”Ÿå¼ç»§æ‰¿

```javascript
function createObj(o) {
  function F() {}
  F.prototype = o
  return new F()
}

function createChild(parent, age) {
  var child = createObj(parent)
  child.age = age
  return child
}

var parent = {
  name: 'parent',
  sayName: function () {
    console.log(this.name)
  },
}

var child = createChild(parent, 18)
child.sayName() // parent
```

## æ—¶é—´å¾ªç¯

## æ—¶é—´å¾ªç¯

## æ—¶é—´å¾ªç¯
