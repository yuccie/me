---
title: '网络基础'
date: Thu Aug 31 2023 23:25:13 GMT+0800 (中国标准时间)
lastmod: '2023-08-31'
tags: ['网络', 'network']
draft: false
summary: '网络基础'
layout: PostSimple
bibliography: references-data.bib
canonicalUrl: https://dume.vercel.app/blog/about-network/1_网络基础.md
---

## 网络基础

了解网络基础对于理解计算机网络的工作原理和进行网络相关的开发和故障排除非常重要。以下是一些网络基础知识的主要方面：

- 协议和标准：了解网络通信所涉及的协议和标准，如 TCP/IP 协议族、HTTP、DNS、SMTP 等。了解它们的作用、工作原理和常见的应用场景。

- IP 地址和子网划分：理解 IP 地址的结构、分类和分配。了解私有 IP 地址和公共 IP 地址的区别，以及子网划分和子网掩码的概念。

- 网络拓扑：了解不同类型的网络拓扑结构，如星型、总线型、环型和网状结构。理解路由器、交换机和集线器等网络设备的作用和区别。

- 网络层次模型：了解 OSI 七层模型或 TCP/IP 四层模型，并了解每个层次的功能和协议。熟悉物理层、数据链路层、网络层、传输层、会话层、表示层和应用层的概念。

- IP 路由和转发：了解 IP 路由的概念，包括路由表、路由选择算法和路由器之间的通信。理解 IP 数据包的转发过程和路由器的作用。

- 域名系统（DNS）：理解 DNS 的作用和原理，包括域名解析过程、DNS 服务器层次和记录类型。

- 传输层协议：熟悉传输层协议，如 TCP 和 UDP。了解它们的特性、用途和区别，以及 TCP 的三次握手和四次挥手过程。

- 网络安全和加密：了解网络安全的基本概念，如防火墙、VPN、SSL/TLS 加密等。熟悉常见的网络攻击类型和防御机制。

- 网络性能和优化：了解网络性能的指标，如延迟、带宽和吞吐量。熟悉网络优化技术，如缓存、负载均衡和内容分发网络（CDN）。

- 网络协议分析工具：熟悉使用网络协议分析工具，如 Wireshark，来捕获和分析网络流量，以便诊断和排除网络问题。

请注意，这只是网络基础知识的概览，并不详尽。网络是一个广阔而复杂的领域，还有许多其他的主题和概念，如无线网络、云计算和软件定义网络（SDN）。对于深入了解网络，可以参考相关的教材、在线课程和实践经验。

## TCP 为什么 TCP 建立连接需要三次握手

我们通常听到，描述 TCP 建立连接为什么需要三次握手：

1. 你听得到吗？
2. 我能听到，你听得到？
3. 我也能听到；

类比带来的解释往往只能有片面的相似性，我们永远也无法找到绝对正确的类比，它只在我们想要通俗易懂地展示事物的特性时才能发挥较大的作用

这里却掩盖了一部分事实

### TCP 的连接是什么？

TCP 中的连接是什么：**用于保证可靠性和流控制机制的信息，包括 Socket、序列号以及窗口大小叫做连接。**

所以，建立 TCP 连接就是通信的双方需要对上述的三种信息达成共识，

- 连接中的一对 Socket 是由互联网地址标志符和端口组成的，
- 窗口大小主要用来做流控制，
- 最后的序列号是用来追踪通信发起方发送的数据包序号，接收方可以通过序列号向发送方确认某个数据包的成功接收。

### 历史连接

TCP 连接使用三次握手的首要原因 ——** 为了阻止历史的重复连接初始化造成的混乱问题，防止使用 TCP 协议通信的双方建立了错误的连接。**

想象一下这个场景，如果通信双方的通信次数只有两次，那么发送方一旦发出建立连接的请求之后它就没有办法撤回这一次请求，如果在网络状况复杂或者较差的网络中，发送方连续发送多次建立连接的请求，如果 TCP 建立连接只能通信两次，那么接收方只能选择接受或者拒绝发送方发起的请求，它并不清楚这一次请求是不是由于网络拥堵而早早过期的连接。

所以，TCP 选择使用三次握手来建立连接并在连接引入了 RST 这一控制消息，接收方当收到请求时会将发送方发来的 SEQ+1 发送给对方，这时由发送方来判断当前连接是否是历史连接：

- 如果当前连接是历史连接，即 SEQ 过期或者超时，那么发送方就会直接发送 RST 控制消息中止这一次连接；
- 如果当前连接不是历史连接，那么发送方就会发送 ACK 控制消息，通信双方就会成功建立连接；

使用三次握手和 RST 控制消息将是否建立连接的最终控制权交给了发送方，因为只有发送方有足够的上下文来判断当前连接是否是错误的或者过期的，这也是 TCP 使用三次握手建立连接的最主要原因。

### 总结

TCP 建立连接时通过三次握手可以有效地避免历史错误连接的建立，减少通信双方不必要的资源消耗，三次握手能够帮助通信双方获取初始化序列号，它们能够保证数据包传输的不重不丢，还能保证它们的传输顺序，不会因为网络传输的问题发生混乱，

## 并发数

在浏览器环境下，HTTP 请求的并发数通常受到浏览器的限制。根据规范，大多数浏览器对同一个域名下的并发请求数有限制，通常为 6 个

这是为了避免对服务器和客户端资源造成过大的压力，同时保持网络性能的平衡。

然而，微信小程序并非在浏览器环境中运行，而是在微信客户端内部。微信小程序框架对网络请求进行了自己的实现和管理，并提供了更高的并发数限制。根据微信小程序的文档，当前的并发请求数限制为 10 个，这意味着同时可以发送最多 10 个网络请求。
